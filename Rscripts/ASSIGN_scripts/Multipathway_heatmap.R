#plot library
library(gplots)

#change this directory to where output.rda is on your system
setwd("Documents/Multipathway_Modeling/bild_signatures-master/adap_adap_multi/")

#load ASSIGN output object
load("output.rda")

#grab rows for the signature in the right order
mat_use <- output.data$processed.data$trainingData_sub[c("HSPB8","SLC34A2","IGFBP5","C10orf81","GRAMD2","CRYAB","STEAP4","CA2","LIMCH1","TRIM22","EDN1","HSPA6","RASD2","TNFAIP2","DAPK1","SMO","FGFR2","SCD5","DNAJA4","EPGN","SYNM","MTUS1","AMOT","NAV2","ELK3","KCNN4","SLC16A6","SLC9A2","SYTL5","DAB2","PHLDA1","CCNA1","METTL7B","NAV3","SPP1","PLAUR","KIAA1199","GRB7","PMP22","CHI3L1","LOC100131726","FGFBP2","STRA6","KRT18","PKIB","SOCS1","ETV5","SPRR3","TMEM158","KLK10","CLMP","CDCP1","HMGA2","APOD","FOSL1","AGPAT9","TGFA","TMPRSS4","TM4SF1","ISG20","SMOX","GAL","S100A4","PLEK2","CEACAM1","FAM176A","CYB5R2","B3GNT3","LY6D","COL6A2","TNS4","SRMS","NT5E","EEF1A2","GJB5","RAF1","SPRR2D","GPR110","KRT13","SERPINB1","DHRS9","HAS2","FGFBP1","PLAU","SERPINB2","GJB3","EMP1","ALOX15B","RAC2","S100A7","PRSS22","STC1","CALB2","PI3","FERMT1","NTSR1","ANPEP","FAM83A","CEACAM6","KLK6","SAA2","CRYAB","TNFAIP2","EPGN","DNAJA4","KLK6","CALB2","PDGFB","KRT18","ANGPTL4","UCA1","EEF1A2","CLDN7","ATP6V0A4","KRT8","CXCL5","INHBA","HSPA6","CRYAB","IL8","FOXQ1","ETS1","KRT23","DNAJA4","SAA2","DLC1","GRB7","GDF15","HSPB8","MGAT4A","MYO5C","ABCG1","DNER","SLC34A2","HSPA1A","TNFAIP2","DUSP6","FOS","CCL20","SATB1","ACSS1","CXCL2","IL11","FOSL1","PDZD2","RBM47","ERRFI1","MARCKS","BMF","NFKBIZ","CLDN4","DAPK1","EGR3","NPNT","NPY1R","FAM214A","COBL","TMEM229B","LTF","FLNC","GAB2","STAT6","WWC3","CFB","LIF","MB21D1","GCNT2","CCDC64B","ZC3H12A","ALDH1A3","BIRC3","HSPA1B","PIM1","SCUBE2","HMOX1","GSDMC","IL17RB","GFPT2","CXCL3","IL7R","DNAJB4","TLR2","CCDC64","PLEKHG4B","BOC","INPP5J","PLEKHA6","AKAP12","FYN","NEURL1B","C1R","C1orf226","ADRB2","HSPA7","UNC5A","SGPP2","PPM1H","PCDH7","KLHL2","NEO1","PARD6B","MYO1D","DFNB31","TCF7L1","CACHD1","GBP3","ZNF469","KIAA1467","FBXL20","NYNRIN","ANKRD33B","LIMCH1","NAV2","SGK1","CXCL6","GRHL2","FGF2","RRAD","RUNX3","GLYATL2","DUSP1","KRT80","RHPN2","ATP9A","FNBP1L","GPRC5A","BCORL1","RAB11FIP1","KLF8","CCDC117","SLC6A14","DGKA","ZNF217","RB1CC1","BCAS3","TIAM2","HSP90AA1","IFRD1","KIAA1244","GM2A","MED23","ABTB2","AGAP11","SMAD3","INSR","CYLD","HSPH1","IKBKE","NCOA2","CITED2","ABCA1","IER5","STARD13","MUM1L1","RHOD","CNN3","ZNF639","SSR3","RPS28","ST6GALNAC4","SIGMAR1","S100A2","DCTD","CAV1","CBR1","ECI2","RFC3","IGFBP5","SPINK6","ACAT2","FAM212A","RWDD2B","PGM1","MAP7D3","KRT81","LOC100499467","TMEM40","PID1","DLEU1","RAB36","FAM126A","MT1X","PIK3R3","C21orf63","LPAR1","NXN","ECHDC1","BDKRB2","ACN9","NPM3","TUBB6","RBBP8","NME4","ACTG2","OSR1","MEST","GPX1","SNCG","RHOB","LHFP","LINC00162","PADI3","PEG10","LGALS1","MT1E","TGFBR2","LIX1L","MYL9","COTL1","NETO2","KLF2","LDHB","PRKCDBP","PTGES","BAD","GPC4","CXCL5","ABCG1","NEDD9","CX3CL1","AKAP12","TMEM139","LIF","TNFAIP2","C14orf132","TLR2","SNAI2","WNT5B","HOXB2","ICAM1","GLUL","CALD1","AKT3","INHBA","PODXL","C10orf10","MFAP3L","F2R","DUSP6","AFAP1L2","MYBL1","SPOCD1","CXCL2","RAI14","PION","LBH","ADAM19","ITGB3","CDK14","CCNDBP1","PLSCR4","CKB","KRT8","CA2","HAS3","ESR1","PPP1R3C","WISP2","RHOB","SIPA1L2","SLC1A6","MT1X","LPAR3","GALNT6","CXCL14","BGN","SLC6A11","SERPINB7","IFITM10","TGFB3","NPNT","LOC100499467","ALDOC","AKT1","SECTM1","GJA1","PKP1","BMP7","CASP14","PLA2G4A","SPRR2A","TUBA4A","PTGES","DDIT4","EPGN","IGFBP2","KRT14","BEX1","CA9","IGFBP5"),]
colnames(mat_use)
genelist=c("HSPB8","SLC34A2","IGFBP5","C10orf81","GRAMD2","CRYAB","STEAP4","CA2","LIMCH1","TRIM22","EDN1","HSPA6","RASD2","TNFAIP2","DAPK1","SMO","FGFR2","SCD5","DNAJA4","EPGN","SYNM","MTUS1","AMOT","NAV2","ELK3","KCNN4","SLC16A6","SLC9A2","SYTL5","DAB2","PHLDA1","CCNA1","METTL7B","NAV3","SPP1","PLAUR","KIAA1199","GRB7","PMP22","CHI3L1","LOC100131726","FGFBP2","STRA6","KRT18","PKIB","SOCS1","ETV5","SPRR3","TMEM158","KLK10","CLMP","CDCP1","HMGA2","APOD","FOSL1","AGPAT9","TGFA","TMPRSS4","TM4SF1","ISG20","SMOX","GAL","S100A4","PLEK2","CEACAM1","FAM176A","CYB5R2","B3GNT3","LY6D","COL6A2","TNS4","SRMS","NT5E","EEF1A2","GJB5","RAF1","SPRR2D","GPR110","KRT13","SERPINB1","DHRS9","HAS2","FGFBP1","PLAU","SERPINB2","GJB3","EMP1","ALOX15B","RAC2","S100A7","PRSS22","STC1","CALB2","PI3","FERMT1","NTSR1","ANPEP","FAM83A","CEACAM6","KLK6","SAA2","CRYAB","TNFAIP2","EPGN","DNAJA4","KLK6","CALB2","PDGFB","KRT18","ANGPTL4","UCA1","EEF1A2","CLDN7","ATP6V0A4","KRT8","CXCL5","INHBA","HSPA6","CRYAB","IL8","FOXQ1","ETS1","KRT23","DNAJA4","SAA2","DLC1","GRB7","GDF15","HSPB8","MGAT4A","MYO5C","ABCG1","DNER","SLC34A2","HSPA1A","TNFAIP2","DUSP6","FOS","CCL20","SATB1","ACSS1","CXCL2","IL11","FOSL1","PDZD2","RBM47","ERRFI1","MARCKS","BMF","NFKBIZ","CLDN4","DAPK1","EGR3","NPNT","NPY1R","FAM214A","COBL","TMEM229B","LTF","FLNC","GAB2","STAT6","WWC3","CFB","LIF","MB21D1","GCNT2","CCDC64B","ZC3H12A","ALDH1A3","BIRC3","HSPA1B","PIM1","SCUBE2","HMOX1","GSDMC","IL17RB","GFPT2","CXCL3","IL7R","DNAJB4","TLR2","CCDC64","PLEKHG4B","BOC","INPP5J","PLEKHA6","AKAP12","FYN","NEURL1B","C1R","C1orf226","ADRB2","HSPA7","UNC5A","SGPP2","PPM1H","PCDH7","KLHL2","NEO1","PARD6B","MYO1D","DFNB31","TCF7L1","CACHD1","GBP3","ZNF469","KIAA1467","FBXL20","NYNRIN","ANKRD33B","LIMCH1","NAV2","SGK1","CXCL6","GRHL2","FGF2","RRAD","RUNX3","GLYATL2","DUSP1","KRT80","RHPN2","ATP9A","FNBP1L","GPRC5A","BCORL1","RAB11FIP1","KLF8","CCDC117","SLC6A14","DGKA","ZNF217","RB1CC1","BCAS3","TIAM2","HSP90AA1","IFRD1","KIAA1244","GM2A","MED23","ABTB2","AGAP11","SMAD3","INSR","CYLD","HSPH1","IKBKE","NCOA2","CITED2","ABCA1","IER5","STARD13","MUM1L1","RHOD","CNN3","ZNF639","SSR3","RPS28","ST6GALNAC4","SIGMAR1","S100A2","DCTD","CAV1","CBR1","ECI2","RFC3","IGFBP5","SPINK6","ACAT2","FAM212A","RWDD2B","PGM1","MAP7D3","KRT81","LOC100499467","TMEM40","PID1","DLEU1","RAB36","FAM126A","MT1X","PIK3R3","C21orf63","LPAR1","NXN","ECHDC1","BDKRB2","ACN9","NPM3","TUBB6","RBBP8","NME4","ACTG2","OSR1","MEST","GPX1","SNCG","RHOB","LHFP","LINC00162","PADI3","PEG10","LGALS1","MT1E","TGFBR2","LIX1L","MYL9","COTL1","NETO2","KLF2","LDHB","PRKCDBP","PTGES","BAD","GPC4","CXCL5","ABCG1","NEDD9","CX3CL1","AKAP12","TMEM139","LIF","TNFAIP2","C14orf132","TLR2","SNAI2","WNT5B","HOXB2","ICAM1","GLUL","CALD1","AKT3","INHBA","PODXL","C10orf10","MFAP3L","F2R","DUSP6","AFAP1L2","MYBL1","SPOCD1","CXCL2","RAI14","PION","LBH","ADAM19","ITGB3","CDK14","CCNDBP1","PLSCR4","CKB","KRT8","CA2","HAS3","ESR1","PPP1R3C","WISP2","RHOB","SIPA1L2","SLC1A6","MT1X","LPAR3","GALNT6","CXCL14","BGN","SLC6A11","SERPINB7","IFITM10","TGFB3","NPNT","LOC100499467","ALDOC","AKT1","SECTM1","GJA1","PKP1","BMP7","CASP14","PLA2G4A","SPRR2A","TUBA4A","PTGES","DDIT4","EPGN","IGFBP2","KRT14","BEX1","CA9","IGFBP5")
length(genelist)
genelist_raf=genelist[1:100]
genelist_her2=genelist[101:115]
(genelist_her2)
genelist_bad=genelist[116:315]
genelist_bad
genelist_akt=genelist[316:390]

genelist_akt

dim(output.data$processed.data$trainingData_sub)

#put gfp last
mat_use <- mat_use[,c(13:35,1:12)]
colnames(mat_use)

mat_use <- mat_use[,c(25:29,13:18, 30:35, 19:24, 1:12)]
length(colnames(mat_use))

colnames(mat_use[13:])

row.names(mat_use)
dim(mat_use)
View(mat_use)
#create the heatmap
pdf("~/Documents/Multipathway_Modeling/bild_signatures-master/adap_adap_multi/AKt_multi_heatmap.pdf")
heatmap(as.matrix(mat_use),scale="row",cexRow=0.1,Rowv=NA,Colv=NA,col=bluered(128), row)
dev.off()
